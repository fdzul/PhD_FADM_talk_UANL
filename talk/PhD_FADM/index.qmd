---
format: 
  revealjs:
    #theme: ["theme/q-theme.scss"]
    slide-number: c/t
    logo: "http://www.fcb.uanl.mx/nw/images/logo_fcb.png"
    footer: "[github.com/fdzul](https://beamish-salmiakki-2b94b9.netlify.app/talk/phd_fadm/#/)"
    center-title-slide: true
highlight-style: a11y
---

<h2>Hotspots de la Transmisión de los virus del Dengue, Chikungunya y Zika en México<br></h2>

<h2>

</h2>

<hr>

<h4>Dr. Felipe Dzul Manzanilla</h4>

<h5>Director: Dra. Adriana Flores Suárez</h5>
<h5>Director: Dr. Gonzalo Vazquez-Prokopec</h5>
<h3>

</h3>

<h5>2022-01-24</h5>

<br>

<h4>

`r fontawesome::fa("github", "black")` [github.com/fdzul](https://fdzul.github.io/web_site_fadm/)

![](chains_merida.jpg){.absolute top="195" left="750" width="550"}

```{r setup}
path_arbo <- "/Users/fdzul/Library/CloudStorage/OneDrive-Personal/datasets/DGE/arbo/"
# 3.1 arbovirosis dataset
x <- boldenr::read_dataset_bol(path = path_arbo,
                                dataset = "sinave")
source("~/Dropbox/r_developments/r_new_functions/3.Functions/static_bump_map.R")
library(sf)
```


## [ETVs en América]{style="color:#003300"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

![](figs/VectorBorneDiseases.jpg){.absolute top="100" width="800" height="550" right="120"}

::: footer
 
[PAHO, 2023](https://ais.paho.org/phip/viz/cha_cd_vectorborndiseases.asp)

:::

## [Manejo Integrado de Aedes]{style="color:#003300"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

![](https://www.ecdc.europa.eu/sites/default/files/images/dengue-cases-worldwide-january-december-2020.jpg)

::: footer
 
[ecdc](https://www.ecdc.europa.eu/en/publications-data/geographical-distribution-dengue-cases-reported-worldwide-2020)

:::


## [Manejo Integrado de Aedes]{style="color:#003300"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

![](https://journals.plos.org/plosntds/article/figure/image?size=large&id=10.1371/journal.pntd.0006845.g001){.absolute top="100" width="800" height="550" right="120"}

::: footer
 
[WHO, 2017; Roiz, 2018](https://doi.org/10.1371/journal.pntd.0006845)

:::


## [Manejo Integrado de Aedes]{style="color:#003300"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

![](paho_2019/Diapositiva1.JPG){.absolute top="100" width="800" height="550" right="120"}

::: footer
 
[OPS, 2019](https://iris.paho.org/handle/10665.2/51654)
[OPS, 2019](https://iris.paho.org/handle/10665.2/51760)

:::

## [Operacionalización del MIA]{style="color:#003300"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

```{r mia_mexico, echo=FALSE, warning=FALSE, message=FALSE}
# Step 1. load the dataset #####
load("/Users/fdzul/Library/CloudStorage/OneDrive-Personal/automatic_read_sinave/8.RData/epid_channel_data.RData")

# Step 2. extract the dengue cases of veracruz ####
x <- x |>
    dplyr::filter(DES_EDO_RES == "VERACRUZ") 

y <- tibble::tibble(SEM = x$SEM,
                    y = x$q25,
                    arm = "Nuevo Paradigma")
prob <- tibble::tibble(SEM = x$SEM,
                       prob = rep(0, length(x$SEM)))

# plot risk stratificaction  #####
ggplot2::ggplot() +
    ggplot2::geom_rect(ggplot2::aes(xmin = c(-Inf, 25), 
                                    xmax = c(25, Inf), 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = c("#2EB67D", "#E01E5A"),
                       alpha = .2) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 20, 
                                    xmax = 25, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "#ECB22E",
                       alpha = 0.8) +
    ggplot2::geom_rect(ggplot2::aes(xmin = 38, 
                                    xmax = 40, 
                                    ymin = -Inf, 
                                    ymax = Inf),
                       fill = "#36C5F0",
                       alpha = 0.8) +
    ggplot2::geom_vline(xintercept = 25,
                        color = "gray", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_vline(xintercept = 20,
                        color = "gray", #"#36C5F0",
                        size = 1,
                        linetype = 3) +
    ggplot2::geom_line(data = x, 
                       ggplot2::aes(x = SEM,
                                    y = q75-10),
                       col = "#E01E5A",
                       size = 3) +
    ggplot2::geom_line(data = y, 
                       ggplot2::aes(x = SEM,
                                    y = y),
                       color = "#2EB67D", #"#36C5F0",
                       size = 3) +
    ggplot2::ylab("Número de Casos") +
    ggplot2::xlab("Semanas Epidemiológicas") +
    ggplot2::annotate("text",
                      label = "Control Proactivo",
                      x = 10, 
                      y = 450,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Escenarios Operativos \nbasados \nen \nTransmisión Persistente",
                      x = 10, 
                      y = 380,
                      #text = "risk",
                      col = "#2EB67D",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control Reactivo",
                      x = 42, 
                      y = 450,
                      #text = "risk",
                      col = "#E01E5A",
                      size = 6) +
    ggplot2::annotate("text",
                      label = "Escenarios Operativos \nbasados \nen \nTransmisión Activa",
                      x = 45, 
                      y = 380,
                      #text = "risk",
                      col = "#E01E5A",
                      size = 4) +
    ggplot2::geom_line(data = prob, 
                       ggplot2::aes(x = SEM,
                                    y = prob),
                       color = "#36C5F0",
                       size = 2)  +
    ggplot2::annotate("text",
                      label = "Acciones Específica Básicas",
                      x = 10, 
                      y = 280,
                      col = "gray",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control de Probables",
                      x = 10, 
                      y = 250,
                      col = "#36C5F0",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Rociado Residual",
                      x = 10, 
                      y = 220,
                      col = "#ECB22E",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Control Larvario",
                      x = 10, 
                      y = 200,
                      col = "#ECB22E",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Acciones Específicas de Soporte",
                      x = 10, 
                      y = 150,
                      col = "gray",
                      size = 4) +
    ggplot2::annotate("text",
                      label = "Termonebulización,\n Nebulización, & \nEliminación Masiva de Criaderos",
                      x = 10, 
                      y = 110,
                      col = "gray",
                      size = 3)

```


## [Hotspots de las arbovirosis]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

:::: {.columns}

::: {.column width="40%"}
Los ***hotspots*** de las arbovirosis transmitidas por ***Aedes aegypti*** son definidas como aquellas áreas donde se concentra la mayor carga de la transmisión de los virus del Dengue, Chikungunya, y/ó Zika.
:::

::: {.column width="60%"}
![](maps/hotspots_ver.jpg)
:::

::::

::: footer
 
[Bisanzio et al 2017;](https://journals.plos.org/plosntds/article?id=10.1371/journal.pntd.0006298)
[Dzul-Manzanilla et al 2021](https://www.thelancet.com/journals/lanplh/article/PIIS2542-5196(21)00030-9/fulltext)

:::

## [Justificación]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

::: {.columns}

::: {.column width="50%"}
Teóricamente, de acuerdo a la ley de Pareto 80/20, si el 80% de la transmisión se concentra en el 20% del área urbana, la focalización de las acciones en el 20% del área, permitiría obtener reducciones del 80% de la carga de la enfermedad
:::

::: {.column width="50%"}
![](maps/intensity_maps_xalapa.jpg)
:::

::::

::: footer
 
[Copper et al, 2019;](https://www.nature.com/articles/s41467-019-11861-y)
[Vazquez-Prokopeck et al 2022](https://academic.oup.com/pnasnexus/article/2/3/pgad024/7010769)

:::

## [Hipotesis]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

[Las arbovirosis transmitidas por ***Aedes aegypti*** presentan concordancia espacial en las áreas de mayor intensidad de transmisión (hotspots), además existe mayor abundancia del vector en las casas alrededor de los casos positivos que en las casas de los casos negativos]()


## [Objetivo General]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

[Análisis espacio-temporal para identificar los hotspots de la transmisión de los virus del DENV, CHIKV y ZIKV en México.]()


## [Objetivos Específicos]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

- [Determinar los hotspots de DENV, CHIKV y ZIKV en localidades endémicas de México y la concordancia espacial de los hotspots de transmisión de DENV, CHIKV y ZIKV.]()

- [Determinar el efecto del tamaño de muestra del número de ovitrampas por manzana en la abundancia de huevos de ***Aedes aegypti***]()

- [Determinar si la abundancia del vector y de huevos son diferentes en las casas alrededor de los casos positivos a dengue (casos) y las casas alrededor de los casos negativos (controles).]()

## [Objetivo 1. Hotspots de Transmisión]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">


![](https://els-jbs-prod-cdn.jbs.elsevierhealth.com/cms/attachment/ca6efc8e-6b7a-44aa-b2ab-affa3009fb54/gr1_lrg.jpg"){.absolute top="100" width="700" height="550" right="220"}

## [Hotspots de la Transmisión]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

```{r, dpi=300,echo=FALSE, fig.align ="center", out.width = "100%"}
DiagrammeR::grViz("digraph {

  # graph definitions
  graph [layout = dot, rankdir = TB]
  
  # node definitions
  node [shape = rectangle, style = filled, color = grey] 
  
  # flowchart for hotspots
  sinave [label = 'SINAVE',  fillcolor = 'SeaGreen', color = 'white', fontcolor = 'white']
  denv [label = 'Bases de DENV',  fillcolor = 'SeaGreen', color = 'white', fontcolor = 'white']
  geocode [label = 'Geocodificación',  fillcolor = 'SeaGreen', color = 'white', fontcolor = 'white']
  cases_ageb [label = 'Casos por AGEBs']
  z_score [label = 'Z-score']
  gi [label = 'Estadístico Espacial Local (Gi*)']
  bonferroni [label = 'Corrección de Bonferroni']
  hotspots [label = 'Hotspots', style = filled, color = orange]
  
  # flow chart for inegi
  inegi [label = 'INEGI', fillcolor = 'DeepSkyBlue', color = 'white', fontcolor = 'black']
  loc [label = 'Localidades Shapefile', fillcolor = 'DeepSkyBlue', color = 'white', fontcolor = 'black']
  ageb [label = 'AGEB Shapefile', fillcolor = 'DeepSkyBlue', color = 'white', fontcolor = 'black']
  loc_esp [label = 'Localidad de Ínteres', fillcolor = 'DeepSkyBlue', color = 'white', fontcolor = 'black']
  ageb_esp [label = 'AGEBs de la Localidad de Ínteres', fillcolor = 'DeepSkyBlue', color = 'white', fontcolor = 'black']
  mat [label = 'Matriz de Adjacencias', fillcolor = 'DeepSkyBlue', color = 'white', fontcolor = 'black']
  
  # edge definitions with the node IDs
  edge [color = black]
  sinave -> denv -> geocode -> cases_ageb -> z_score -> gi -> bonferroni -> hotspots 
  inegi -> {ageb, loc}
  loc -> loc_esp -> ageb_esp
  ageb -> ageb_esp
  ageb_esp -> mat
  mat -> cases_ageb 
 
  }", 
  height = 550)

```

::: footer
 
[Dzul-Manzanilla et al 2021](https://www.thelancet.com/journals/lanplh/article/PIIS2542-5196(21)00030-9/fulltext)

:::


## Estadístico Espacial Local $\color{#2ECC40}{G_i^*}$
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">


$$\color{#2ECC40}{G_i^*} = \frac{\color{#FF4136}{\sum_{i = 1}^{n} W_{ij}x_{ij}}}{\color{#0074D9}{\sum_{i = 1}^{n}x_{i}}}$$
$\color{#FF4136}{\sum_{i = 1}^{n} W_{ij}x_{j}}$ es el numerador, $x_{ij}$ representa la suma de los valores $x$ (casos) de  la unidad espacial de interes $x_{i}$ y sus vecinos $x{_j}$, incluyendo el valor de la unidad $i$, $\color{#FF4136}w_{\color{#FF4136}i\color{#FF4136}j}$ es la matriz de adjacencias.

$\color{#0074D9}{\sum_{i = 1}^{n}x_{i}}$ es el denominador, es la suma de todos los valores $x_i$ en toda la localidad de interes.


::: footer
 
[Getis & Ord. 1992;](https://onlinelibrary.wiley.com/doi/10.1111/j.1538-4632.1992.tb00261.x)
[Ord & Getis 1995](https://onlinelibrary.wiley.com/doi/10.1111/j.1538-4632.1995.tb00912.x)

:::

## [Objetivo 2. Sitio de Estudio]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

::: {.columns}

::: {.column width="50%"}
- **Muestro sistemático**
- **Muestreo por autoselección**
- **Colecta semanal**
- **Captura en línea**
:::

::: {.column width="50%"}
```{r}
#  Step 1. load the function ####
source("~/Library/CloudStorage/Dropbox/r_developments/r_new_functions/3.Functions/deneggs/blocks_surveillance.R")
######
path_coord <- "/Users/fdzul/Library/CloudStorage/OneDrive-Personal/datasets/CENAPRECE/2022/30_veracruz/DescargaOvitrampasMesFco.txt"
blocks_surveillance(locality = "Veracruz",
                    cve_ent = "30",
                    path_coords = path_coord)
```

:::

::::

::: footer
 
[Guías Operativas Arbovirosis](https://www.gob.mx/salud/cenaprece/documentos/guias-operativas-de-arbovirosis-2020?idiom=es)

:::


## [Objetivo 2. Hipótesis]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

[El número de huevos es similar independiente del número de ovitrampas por manzana, es decir el muestreo de cuatro ovitrampas por manzana proporciona similar información que tres ovitrampas por manzana, dos ovitrampas por manzana, y una ovitrampa por manzana.]()

## [Diagrama de Flujo]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">


```{r, echo=FALSE, out.width='100%', fig.align='center'}
DiagrammeR::grViz("digraph {
                  # graph definitions
  graph [layout = dot, rankdir = TB]
  
  # node definitions
  node [shape = rectangle, 
  style = filled, 
  color = grey, 
  nodesep = .5,
  fixedsize = true, 
  width = 2.5] 
  
  # edge definition
  edge [color = grey, arrowhead = normal, arrowtail = dot]
  
  #####  cenaprece
  
 cenaprece [label = 'CENAPRECE',  fillcolor =  '#FF5A5F', color = 'white', fontcolor = 'white']
 
 ovitrap [label = 'Ovitrap Dataset',  fillcolor =  '#FF5A5F', color = 'white', fontcolor = 'white']
 
 merida [label = 'Veracruz',  fillcolor =  '#FF5A5F', color = 'white', fontcolor = 'white']
 
 ##### inegi 
 inegi [label = 'INEGI',  fillcolor =  '#2EB67D', color = 'white', fontcolor = 'white']
  
   blocks [label = 'Blocks',  fillcolor =  '#2EB67D', color = 'white', fontcolor = 'white']
 
 centroid [label = 'centroid',  fillcolor =  '#2EB67D', color = 'white', fontcolor = 'white']
 
 ##### dataset
 dataset [label = 'Dataset',  fillcolor =  '#4285F4', color = 'white', fontcolor = 'white']
 
 dataset_nested [label = 'Dataset Nested',  fillcolor =  '#4285F4', color = 'white', fontcolor = 'white']
 
 temporal [label = 'Temporal',  fillcolor =  '#4285F4', color = 'white', fontcolor = 'white']
 
 spatial [label = 'Spatial',  fillcolor =  '#4285F4', color = 'white', fontcolor = 'white']
 
 
 ##### bootstrap 
 bootstrap [label = 'Combinaciones/Bootstrap',  fillcolor =  '#E01E5A', color = 'white', fontcolor = 'white']
 
 block [label = 'Block',  fillcolor =  '#E01E5A', color = 'white', fontcolor = 'white']
  abootstrap [label = '1 ovitrap',  fillcolor =  '#E01E5A', color = 'white', fontcolor = 'white']
 
  bbootstrap [label = '2 ovitraps',  fillcolor =  '#E01E5A', color = 'white', fontcolor = 'white']
 
  cbootstrap [label = '3 ovitraps',  fillcolor =  '#E01E5A', color = 'white', fontcolor = 'white']
 
  dbootstrap [label = '4 ovitraps',  fillcolor =  '#E01E5A', color = 'white', fontcolor = 'white']
 
 ##### ESDA
  eda [label = 'EDA',  fillcolor =  '#36C5F0', color = 'white', fontcolor = 'white']
 
 mean [label = 'Mean + SE',  fillcolor =  '#36C5F0', color = 'white', fontcolor = 'white']
 
  quantile [label = 'Quantile',  fillcolor =  '#36C5F0', color = 'white', fontcolor = 'white']
 
 #### Analysis
 analysis [label = 'Analysis',  fillcolor =  '#ECB22E', color = '#ECB22E', fontcolor = 'white']
 
 glmm [label = 'GLMM',  fillcolor =  '#ECB22E', color = '#ECB22E', fontcolor = 'white']
 
 tpl [label = 'Taylor Power Law Analysis',  fillcolor =  '#ECB22E', color = '#ECB22E', fontcolor = 'white']
 
 
 
 ##### define the relation
 
cenaprece -> ovitrap -> merida
inegi -> blocks -> centroid
 {centroid merida} -> dataset
dataset -> dataset_nested -> {temporal spatial}-> bootstrap
bootstrap -> block 

block -> {abootstrap bbootstrap cbootstrap dbootstrap} -> {eda analysis}

eda -> {mean quantile}
analysis -> {glmm tpl}  

}")

```

## [Modelo de Regresión]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

$$\color{#2ECC40}{y_i} = \color{#FF4136}{\beta_0} + \color{#0074D9}{\beta_1x} + \color{#F4B400}{\alpha_i} + \color{#6200B4}{\epsilon_i}$$
donde:
<h1 style="font-size:2.5vw;">
$\color{#2ECC40}{y_i}$ representa el número de huevos por ovitrampa.<br>
$\color{#FF4136}{\beta_0}$ es el intercepto de la ecuación. <br>
$\color{#0074D9}{\beta_1x}$ es el coeficiente de la diferencia del número huevos entre los diferentes tamaños de muestra (se tomó como referencia la base de datos completa, cuatro ovitrampas por manzana).<br>
$\color{#F4B400}{\alpha_i}$ el efecto del intercepto aleatorio, anida las observaciones por sector, manzana, localidad y municipio.<br>
$\color{#6200B4}{\epsilon_i}$ representan el error, el cual incorporará la variabilidad natural del sistema biológico y el error observacional o de medición.<br>
Los modelos asumen que los interceptos aleatorios y el error son distribuidos independientemente e idénticos con media cero y una varianza.Los modelos fueron implementados para cada combinación de año y semana.</h1>


## [Dios Botic]{style="color:#003300;"}
<hr style="height:2px;border-width:0;color:#330019;background-color:#330019">

-   [***Bio***](https://fdzul.github.io/web_site_fadm/)

-   ***email*** : [felipe.dzul.m@gmail.com]()

-   ***celular*** : [8139945623]()

-   [***slides***](https://beamish-salmiakki-2b94b9.netlify.app/talk/phd_fadm/#/)

